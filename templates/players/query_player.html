<!DOCTYPE html>
<html>
<head>
    <title>Player Search</title>
</head>
<body>
    <h1>Search for a Player</h1>
    <form method="get">
        {{ form.as_p }}
        <button type="submit">Search</button>
    </form>

    {% if players_with_matches %}
        <h2>Search Results</h2>
        {% for item in players_with_matches %}
            <h3>{{ item.player.name_first }} {{ item.player.name_last }}</h3>
            <p>Hand: {{ item.player.hand }}</p>
            <p>Date of Birth: {{ item.player.dob }}</p>
            <p>Nationality: {{ item.player.ioc }}</p>
            <p>Height: {{ item.player.height }}</p>

            {% if item.recent_matches %}
                <h4>Recent Matches:</h4>
                <table border="1">
                    <thead>
                        <tr>
                            <th>Tournament</th>
                            <th>Date</th>
                            <th>Round</th>
                            <th>Opponent</th>
                            <th>Score</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for match in item.recent_matches %}
                            <tr>
                                <td>{{ match.tourney_name }}</td>
                                <td>{{ match.tourney_date }}</td>
                                <td>{{ match.round }}</td>
                                <td>
                                    {% if match.winner_id == item.player.player_id %}
                                        {{ match.loser_name }}
                                    {% else %}
                                        {{ match.winner_name }}
                                    {% endif %}
                                </td>
                                <td>{{ match.score }}</td>
                                <td>
                                    {% if match.winner_id == item.player.player_id %}
                                        Win
                                    {% else %}
                                        Loss
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No recent matches found.</p>
            {% endif %}
        {% endfor %}
    {% else %}
        <p>No players found.</p>
    {% endif %}
</body>
</html>
